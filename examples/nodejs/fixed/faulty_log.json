{
  "source": "/home/tom/github/wronai/pactown-debug/examples/nodejs/faulty.js",
  "fixed": "/home/tom/github/wronai/pactown-debug/examples/nodejs/fixed/fixed_faulty.js",
  "language": "nodejs",
  "errors": 1,
  "warnings": 14,
  "fixes": 6,
  "details": {
    "language": "nodejs",
    "originalCode": "#!/usr/bin/env node\n// Faulty Node.js code with common issues\n\nconst fs = require('fs');\nconst http = require('http');\nvar path = require('path');\n\nvar data = fs.readFileSync('/tmp/data.txt', 'utf8');\nconsole.log(\"Data loaded: \" + data);\n\nvar config = {\n    port: process.env.PORT\n};\n\nif (config.port == undefined) {\n    config.port = 3000;\n}\n\nfunction processFile(filename) {\n    var content = fs.readFileSync(filename);\n    console.log(\"Processing: \" + filename);\n    \n    if (content == null) {\n        return;\n    }\n    \n    var result = eval(content.toString());\n    return result;\n}\n\nhttp.createServer(function() {\n    console.log(\"Request received\");\n    var response = fs.readFileSync('./response.html');\n    return response;\n}).listen(config.port);\n\nmodule.exports = {\n    processFile: processFile\n};\n",
    "fixedCode": "#!/usr/bin/env node\n// Faulty Node.js code with common issues\n\nconst fs = require('fs');\nconst http = require('http');\nlet path = require('path');\n\nlet data = fs.readFileSync('/tmp/data.txt', 'utf8');\nconsole.log(\"Data loaded: \" + data);\n\nlet config = {\n    port: process.env.PORT\n};\n\nif (config.port == undefined) {\n    config.port = 3000;\n}\n\nfunction processFile(filename) {\n    let content = fs.readFileSync(filename);\n    console.log(\"Processing: \" + filename);\n    \n    if (content == null) {\n        return;\n    }\n    \n    let result = eval(content.toString());\n    return result;\n}\n\nhttp.createServer(function() {\n    console.log(\"Request received\");\n    let response = fs.readFileSync('./response.html');\n    return response;\n}).listen(config.port);\n\nmodule.exports = {\n    processFile: processFile\n};\n",
    "errors": [
      {
        "line": 27,
        "column": 1,
        "code": "JS004",
        "message": "eval() jest niebezpieczne - unikaj",
        "severity": "warning"
      }
    ],
    "warnings": [
      {
        "line": 6,
        "column": 1,
        "code": "JS001",
        "message": "Użyj let/const zamiast var",
        "severity": "warning"
      },
      {
        "line": 8,
        "column": 1,
        "code": "JS001",
        "message": "Użyj let/const zamiast var",
        "severity": "warning"
      },
      {
        "line": 8,
        "column": 1,
        "code": "NODE002",
        "message": "Sync I/O blokuje event loop - użyj async",
        "severity": "warning"
      },
      {
        "line": 9,
        "column": 1,
        "code": "JS003",
        "message": "console.log w kodzie produkcyjnym",
        "severity": "warning"
      },
      {
        "line": 11,
        "column": 1,
        "code": "JS001",
        "message": "Użyj let/const zamiast var",
        "severity": "warning"
      },
      {
        "line": 15,
        "column": 1,
        "code": "JS002",
        "message": "Użyj === zamiast ==",
        "severity": "warning"
      },
      {
        "line": 20,
        "column": 1,
        "code": "JS001",
        "message": "Użyj let/const zamiast var",
        "severity": "warning"
      },
      {
        "line": 20,
        "column": 1,
        "code": "NODE002",
        "message": "Sync I/O blokuje event loop - użyj async",
        "severity": "warning"
      },
      {
        "line": 21,
        "column": 1,
        "code": "JS003",
        "message": "console.log w kodzie produkcyjnym",
        "severity": "warning"
      },
      {
        "line": 23,
        "column": 1,
        "code": "JS002",
        "message": "Użyj === zamiast ==",
        "severity": "warning"
      },
      {
        "line": 27,
        "column": 1,
        "code": "JS001",
        "message": "Użyj let/const zamiast var",
        "severity": "warning"
      },
      {
        "line": 32,
        "column": 1,
        "code": "JS003",
        "message": "console.log w kodzie produkcyjnym",
        "severity": "warning"
      },
      {
        "line": 33,
        "column": 1,
        "code": "JS001",
        "message": "Użyj let/const zamiast var",
        "severity": "warning"
      },
      {
        "line": 33,
        "column": 1,
        "code": "NODE002",
        "message": "Sync I/O blokuje event loop - użyj async",
        "severity": "warning"
      }
    ],
    "fixes": [
      {
        "line": 6,
        "description": "Zamieniono var na let",
        "before": "var path = require('path');",
        "after": "let path = require('path');"
      },
      {
        "line": 8,
        "description": "Zamieniono var na let",
        "before": "var data = fs.readFileSync('/tmp/data.txt', 'utf8');",
        "after": "let data = fs.readFileSync('/tmp/data.txt', 'utf8');"
      },
      {
        "line": 11,
        "description": "Zamieniono var na let",
        "before": "var config = {",
        "after": "let config = {"
      },
      {
        "line": 20,
        "description": "Zamieniono var na let",
        "before": "var content = fs.readFileSync(filename);",
        "after": "let content = fs.readFileSync(filename);"
      },
      {
        "line": 27,
        "description": "Zamieniono var na let",
        "before": "var result = eval(content.toString());",
        "after": "let result = eval(content.toString());"
      },
      {
        "line": 33,
        "description": "Zamieniono var na let",
        "before": "var response = fs.readFileSync('./response.html');",
        "after": "let response = fs.readFileSync('./response.html');"
      }
    ],
    "context": {}
  }
}